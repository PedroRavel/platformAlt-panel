{"version":3,"sources":["../src/platformalt_ctrl.js"],"names":["moment","$","_","kbn","config","TimeSeries","MetricsPanelCtrl","PlatformAltCtrl","$scope","$injector","panelDefaults","legend","show","values","width","height","fontSize","fontWeight","font","family","platformName","childChoice","platformChildren","aliases","message","labelMessage","image","text","title","name","subText","defaults","panel","events","on","onInitEditMode","bind","render","onDataReceived","addEditorTab","dataList","series","map","seriesHandler","handleData","checkGarbage","calculateTransaction","seriesData","datapoints","alias","target","flotpairs","getFlotPairs","nullPointMode","label","length","key","defect","value","push","ctrl","self","forEach","data","indexOf","lastPoint","last","lastValue","isArray","parseInt","warningThreshhold","criticalThreshold","found","critical","warning","allOk","indexOfCritical","indexOfWarning","splice","unshift","messages","scope","elem","$panelContainer","find","bgColor","css","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACOA,Y;;AAGAC,O;;AACAC,O;;AAEAC,S;;AACAC,Y;;AACAC,gB;;AACCC,sB,kBAAAA,gB;;;;;;;;;;;;;;;;;;;;;iCAEKC,e;;;AACX,iCAAYC,MAAZ,EAAmBC,SAAnB,EAA6B;AAAA;;AAAA,wIACrBD,MADqB,EACdC,SADc;;AAE3B,cAAMC,gBAAgB;AACpBC,oBAAQ;AACNC,oBAAM,IADA,EACM;AACZC,sBAAQ;AAFF,aADY;AAKpBC,mBAAM,GALc;AAMpBC,oBAAO,GANa;AAOpBC,sBAAU,EAPU;AAQpBC,wBAAY,MARQ;AASpBC,kBAAM,EAAEC,QAAQ,8DAAV,EATc;AAUpBC,0BAAa,EAVO;AAWpBC,yBAAY,EAXQ;AAYpBC,8BAAiB,EAZG;AAapBC,qBAAQ,EAbY;AAcpBC,qBAAQ,EAdY;AAepBC,0BAAa,EAfO;AAgBpBC,mBAAM,YAhBc;AAiBpBC,kBAAK;AACHC,qBAAM,EADH;AAEHC,oBAAK,EAFF;AAGHC,uBAAQ;AAHL;AAjBe,WAAtB;AAuBA5B,YAAE6B,QAAF,CAAW,MAAKC,KAAhB,EAAuBtB,aAAvB;AACAR,YAAE6B,QAAF,CAAW,MAAKC,KAAL,CAAWrB,MAAtB,EAA8BD,cAAcC,MAA5C;AACA,gBAAKsB,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAgC,MAAKC,cAAL,CAAoBC,IAApB,OAAhC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,mBAAf,EAAoC,MAAKG,MAAL,CAAYD,IAAZ,OAApC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKI,cAAL,CAAoBF,IAApB,OAAhC;;AA7B2B;AA+B5B;;;;2CACgB;AACf,iBAAKG,YAAL,CAAkB,SAAlB,EAA4B,sDAA5B,EAAmF,CAAnF;AACA,iBAAKA,YAAL,CAAkB,kBAAlB,EAAqC,yDAArC,EAA+F,CAA/F;AACD;;;yCAEcC,Q,EAAU;;AAGvB,iBAAKC,MAAL,GAAcD,SAASE,GAAT,CAAa,KAAKC,aAAL,CAAmBP,IAAnB,CAAwB,IAAxB,CAAb,CAAd;AACA,iBAAKQ,UAAL;AACA;AACA,iBAAKC,YAAL;AACA,iBAAKC,oBAAL;AACD;;;wCAEaC,U,EAAY;AACxB,gBAAIN,SAAS,IAAIpC,UAAJ,CAAe;AAC1B2C,0BAAYD,WAAWC,UADG;AAE1BC,qBAAOF,WAAWG;AAFQ,aAAf,CAAb;AAIAT,mBAAOU,SAAP,GAAmBV,OAAOW,YAAP,CAAoB,KAAKpB,KAAL,CAAWqB,aAA/B,CAAnB;;AAEA,mBAAOZ,MAAP;AACD;;;uCAGYa,K,EAAM;AACjB,iBAAKtB,KAAL,CAAWP,YAAX,CAAwB8B,MAAxB,GAAiC,CAAjC;AACA,iBAAI,IAAIC,GAAR,IAAe,KAAKxB,KAAL,CAAWV,gBAA1B,EAA2C;AACzC,mBAAKU,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwC5B,IAAxC,GAA+CyB,KAA/C;AACA,kBAAG,KAAKtB,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwCC,KAA3C,EAAiD;AAC/C,qBAAK1B,KAAL,CAAWP,YAAX,CAAwBkC,IAAxB,CAA6B,KAAK3B,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,GAAxC,GAC7B,KAAKG,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwC5B,IADxC;AAED;AACF;AACD+B,iBAAKvB,MAAL;AACD;;;4CAGiBmB,G,EAAI;AACpB,mBAAO,KAAKxB,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,CAAP;AACD;;;uCAGW;AACV;AACA,iBAAKxB,KAAL,CAAWT,OAAX,GAAqB,EAArB;AACA,gBAAIsC,OAAO,IAAX;AACAA,iBAAKpB,MAAL,CAAYqB,OAAZ,CAAoB,UAASC,IAAT,EAAc;AAChC;AACA;AACA,kBAAGA,KAAKd,KAAL,CAAWe,OAAX,CAAmB,GAAnB,IAA0B,CAA7B,EAA+B;AAC7B,oBAAIC,YAAY/D,EAAEgE,IAAF,CAAOH,KAAKf,UAAZ,CAAhB;AACA,oBAAImB,YAAYjE,EAAEkE,OAAF,CAAUH,SAAV,IAAuBI,SAASJ,UAAU,CAAV,CAAT,CAAvB,GAAgD,IAAhE;AACAJ,qBAAK7B,KAAL,CAAWT,OAAX,CAAmBoC,IAAnB,CAAwBI,KAAKd,KAA7B;AACA;AACA;AACA,oBAAGY,KAAK7B,KAAL,CAAWV,gBAAX,CAA4ByC,KAAKd,KAAjC,CAAH,EAA2C;AACzCY,uBAAK7B,KAAL,CAAWV,gBAAX,CAA4ByC,KAAKd,KAAjC,EAAwCS,KAAxC,GAAgDS,SAAhD;AACD,iBAFD,MAEO;AACL;AACAN,uBAAK7B,KAAL,CAAWV,gBAAX,CAA4ByC,KAAKd,KAAjC,IAA0C;AACxCpB,0BAAMkC,KAAKd,KAD6B;AAExCS,2BAAOS,SAFiC;AAGxCG,uCAAkB,GAHsB;AAIxCC,uCAAkB,GAJsB;AAKxCC,2BAAM,IALkC;AAMxCf,4BAAQ;AACN5B,4BAAK,YADC;AAEN6B,6BAAM;AAFA;AANgC,mBAA1C;AAWD;AACF;AACF,aA1BD;AA2BD;;;0CAIc;AACb,gBAAIG,OAAO,IAAX;AACA,iBAAI,IAAIL,GAAR,IAAeK,KAAK7B,KAAL,CAAWV,gBAA1B,EAA2C;AACzC,kBAAIkD,QAAQ,KAAZ;AACAX,mBAAK7B,KAAL,CAAWT,OAAX,CAAmBuC,OAAnB,CAA2B,UAASb,KAAT,EAAe;AAC1C,oBAAGA,UAAUO,GAAb,EAAiB;AACbgB,0BAAQ,IAAR;AACA;AACD;AACF,eALD;AAMA,kBAAG,CAACA,KAAJ,EAAU;AACR,uBAAOX,KAAK7B,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,CAAP;AACD;AACF;AACF;;;yCAIa;AACZ,gBAAIK,OAAO,IAAX;AACA,iBAAI,IAAIL,GAAR,IAAeK,KAAK7B,KAAL,CAAWV,gBAA1B,EAA2C;AACzC,kBAAIkD,QAAQ,KAAZ;AACAX,mBAAK7B,KAAL,CAAWT,OAAX,CAAmBuC,OAAnB,CAA2B,UAASb,KAAT,EAAe;AACxC,oBAAGA,UAAUO,GAAb,EAAiB;AACfgB,0BAAQ,IAAR;AACA;AACD;AACF,eALD;AAMAX,mBAAK7B,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCgB,KAAjC,GAAyCA,KAAzC;AACD;AACF;;;yCAGa;AACZ,iBAAKxC,KAAL,CAAWP,YAAX,CAAwB8B,MAAxB,GAAiC,CAAjC;AACA,iBAAI,IAAIC,GAAR,IAAe,KAAKxB,KAAL,CAAWV,gBAA1B,EAA2C;AACzC,kBAAG,KAAKU,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwCC,KAA3C,EAAiD;AAC/C,qBAAK1B,KAAL,CAAWP,YAAX,CAAwBkC,IAAxB,CAA6B,KAAK3B,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,GAAxC,GAC7B,KAAKG,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwC5B,IADxC;AAED;AACF;AACF;;;4CAIiB2B,G,EAAI;;AAEpB,gBAAG,CAAC,KAAKxB,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwCC,KAA5C,EAAkD;AAC9C,kBAAIe,WAAW,KAAf;AACA,kBAAIC,UAAU,KAAd;AACA,kBAAIC,QAAQ,IAAZ;AACA,kBAAIC,kBAAkB,KAAK5C,KAAL,CAAWP,YAAX,CAAwBuC,OAAxB,CAAgC,KAAKhC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAyC,aAAzE,CAAtB;AACA,kBAAIgD,iBAAiB,KAAK7C,KAAL,CAAWP,YAAX,CAAwBuC,OAAxB,CAAgC,KAAKhC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAyC,YAAzE,CAArB;AACA,kBAAG,KAAKG,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCgB,KAAjC,KAA2C,IAA9C,EAAmD;AACjD,oBAAG,KAAKxC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCE,KAAjC,IAA0CW,SAAS,KAAKrC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCe,iBAA1C,CAA7C,EAA0G;AACxG,uBAAKvC,KAAL,CAAWN,KAAX,GAAmB,WAAnB;AACA,sBAAGmD,mBAAmB,CAAC,CAAvB,EAAyB;AACvB,yBAAK7C,KAAL,CAAWP,YAAX,CAAwBqD,MAAxB,CAA+BD,cAA/B,EAA+C,CAA/C;AACD;AACD,sBAAGD,mBAAmB,CAAC,CAAvB,EAAyB;AACvB,yBAAK5C,KAAL,CAAWP,YAAX,CAAwBsD,OAAxB,CAAgC,KAAK/C,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,aAAxE;AACD;AACD4C,6BAAW,IAAX;AACD,iBATD,MASO,IAAG,KAAKzC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCE,KAAjC,IAA0CW,SAAS,KAAKrC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCc,iBAA1C,CAA1C,IAA0G,CAACG,QAA9G,EAAuH;AAC5H,uBAAKzC,KAAL,CAAWN,KAAX,GAAmB,aAAnB;AACA,sBAAGkD,oBAAoB,CAAC,CAAxB,EAA0B;AACxB,yBAAK5C,KAAL,CAAWP,YAAX,CAAwBqD,MAAxB,CAA+BF,eAA/B,EAAgD,CAAhD;AACD;AACD,sBAAGC,kBAAkB,CAAC,CAAtB,EAAwB;AACtB,yBAAK7C,KAAL,CAAWP,YAAX,CAAwBsD,OAAxB,CAAgC,KAAK/C,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,YAAxE;AACD;AACD6C,4BAAU,IAAV;AACD;AACF;AACD,kBAAG,CAACD,QAAD,IAAa,CAACC,OAAjB,EAAyB;AACvB,oBAAGG,iBAAiB,CAAC,CAArB,EAAuB;AACrB,uBAAK7C,KAAL,CAAWP,YAAX,CAAwBqD,MAAxB,CAA+BD,cAA/B,EAA8C,CAA9C;AACD;AACD,oBAAGD,kBAAkB,CAAC,CAAtB,EAAwB;AACtB,uBAAK5C,KAAL,CAAWP,YAAX,CAAwBqD,MAAxB,CAA+BF,eAA/B,EAA+C,CAA/C;AACD;;AAED,qBAAK5C,KAAL,CAAWP,YAAX,CAAwBqC,OAAxB,CAAgC,UAASkB,QAAT,EAAkB;AAChD,sBAAGA,SAAShB,OAAT,CAAiB,SAAjB,IAA8B,CAAC,CAA/B,IAAoCgB,SAAShB,OAAT,CAAiB,UAAjB,IAA+B,CAAC,CAAvE,EAAyE;AACvEW,4BAAQ,KAAR;AACA;AACD;AACF,iBALD;AAMA,oBAAGA,KAAH,EAAS;AACP,sBAAG,KAAK3C,KAAL,CAAWT,OAAX,CAAmBgC,MAAnB,KAA8B,CAAjC,EAAmC;AACjC,yBAAKvB,KAAL,CAAWN,KAAX,GAAmB,WAAnB;AACD,mBAFD,MAEO;AACL,yBAAKM,KAAL,CAAWN,KAAX,GAAmB,YAAnB;AACD;AACF;AACF;AACF;AACH,iBAAKW,MAAL;AACD;;;iDAIqB;AACpB,gBAAIoC,WAAW,KAAf;AACA,gBAAIC,UAAU,KAAd;AACA,iBAAK1C,KAAL,CAAWP,YAAX,CAAwB8B,MAAxB,GAAiC,CAAjC;AACA,iBAAI,IAAIC,GAAR,IAAe,KAAKxB,KAAL,CAAWV,gBAA1B,EAA2C;AACzC,kBAAG,KAAKU,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwCC,KAA3C,EAAiD;AAC/C,qBAAK1B,KAAL,CAAWP,YAAX,CAAwBkC,IAAxB,CAA6B,KAAK3B,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,GAAxC,GAC7B,KAAKG,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCC,MAAjC,CAAwC5B,IADxC;AAED,eAHD,MAGM;AACF,oBAAG,KAAKG,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCgB,KAAjC,KAA2C,IAA9C,EAAmD;AACjD,sBAAG,KAAKxC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCE,KAAjC,IAA0CW,SAAS,KAAKrC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCe,iBAA1C,CAA7C,EAA0G;AACxG,yBAAKvC,KAAL,CAAWN,KAAX,GAAmB,WAAnB;AACA,yBAAKM,KAAL,CAAWP,YAAX,CAAwBsD,OAAxB,CAAgC,KAAK/C,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,aAAxE;AACA4C,+BAAW,IAAX;AACD,mBAJD,MAIO,IAAG,KAAKzC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCE,KAAjC,IAA0CW,SAAS,KAAKrC,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiCc,iBAA1C,CAA1C,IAA0G,CAACG,QAA9G,EAAuH;AAC5H,yBAAKzC,KAAL,CAAWN,KAAX,GAAmB,aAAnB;AACA,yBAAKM,KAAL,CAAWP,YAAX,CAAwBsD,OAAxB,CAAgC,KAAK/C,KAAL,CAAWV,gBAAX,CAA4BkC,GAA5B,EAAiC3B,IAAjC,GAAwC,YAAxE;AACA6C,8BAAU,IAAV;AACD;AACF;AACF;AACJ;AACD,gBAAG,CAACD,QAAD,IAAa,CAACC,OAAjB,EAAyB;AACvB,kBAAG,KAAK1C,KAAL,CAAWT,OAAX,CAAmBgC,MAAnB,KAA8B,CAAjC,EAAmC;AACjC,qBAAKvB,KAAL,CAAWN,KAAX,GAAmB,WAAnB;AACD,eAFD,MAEO;AACL,qBAAKM,KAAL,CAAWN,KAAX,GAAmB,YAAnB;AACD;AACF;AACD,iBAAKW,MAAL;AACD;;;+BAEI4C,K,EAAOC,I,EAAM;AAAA;;AAChB,iBAAKjD,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,YAAM;AAC7B,kBAAMiD,kBAAkBD,KAAKE,IAAL,CAAU,kBAAV,CAAxB;AACA,kBAAI,OAAKpD,KAAL,CAAWqD,OAAf,EAAwB;AACtBF,gCAAgBG,GAAhB,CAAoB,kBAApB,EAAwC,OAAKtD,KAAL,CAAWqD,OAAnD;AACD,eAFD,MAEO;AACLF,gCAAgBG,GAAhB,CAAoB,kBAApB,EAAwC,EAAxC;AACD;AAEF,aARD;AAUD;;;;QAjQkChF,gB;;;;AAoQrCC,sBAAgBgF,WAAhB,GAA8B,aAA9B","file":"platformalt_ctrl.js","sourcesContent":["\nimport moment from 'moment';\n\n\nimport $ from 'jquery';\nimport _ from 'lodash';\n\nimport kbn from 'app/core/utils/kbn';\nimport config from 'app/core/config';\nimport TimeSeries from 'app/core/time_series2';\nimport {MetricsPanelCtrl} from 'app/plugins/sdk';\n\nexport class PlatformAltCtrl extends MetricsPanelCtrl {\n  constructor($scope,$injector){\n    super($scope,$injector);\n    const panelDefaults = {\n      legend: {\n        show: true, // disable/enable legend\n        values: true\n      },\n      width:100,\n      height:100,\n      fontSize: 25,\n      fontWeight: '10px',\n      font: { family: 'Myriad Set Pro, Helvetica Neue, Helvetica, Arial, sans-serif' },\n      platformName:\"\",\n      childChoice:\"\",\n      platformChildren:{},\n      aliases:[],\n      message:\"\",\n      labelMessage:[],\n      image:\"nodata.png\",\n      text:{\n        title:'',\n        name:'',\n        subText:''\n      }\n    }\n    _.defaults(this.panel, panelDefaults);\n    _.defaults(this.panel.legend, panelDefaults.legend);\n    this.events.on('init-edit-mode',this.onInitEditMode.bind(this));\n    this.events.on('panel-initialized', this.render.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n\n  }\n  onInitEditMode() {\n    this.addEditorTab('Options','public/plugins/grafana-platformalt-panel/editor.html',2);\n    this.addEditorTab('All Transactions','public/plugins/grafana-platformalt-panel/transedit.html',2);\n  }\n\n  onDataReceived(dataList) {\n\n\n    this.series = dataList.map(this.seriesHandler.bind(this));\n    this.handleData();\n    //this.removeGarbage();\n    this.checkGarbage();\n    this.calculateTransaction();\n  }\n\n  seriesHandler(seriesData) {\n    var series = new TimeSeries({\n      datapoints: seriesData.datapoints,\n      alias: seriesData.target,\n    });\n    series.flotpairs = series.getFlotPairs(this.panel.nullPointMode);\n\n    return series;\n  }\n\n  //sets all labels for each platform\n  setAllLabels(label){\n    this.panel.labelMessage.length = 0;\n    for(var key in this.panel.platformChildren){\n      this.panel.platformChildren[key].defect.name = label;\n      if(this.panel.platformChildren[key].defect.value){\n        this.panel.labelMessage.push(this.panel.platformChildren[key].name + \"-\" +\n        this.panel.platformChildren[key].defect.name);\n      }\n    }\n    ctrl.render();\n  }\n\n  //manually delete a transaction that will not be queried anymore\n  removeTransaction(key){\n    delete this.panel.platformChildren[key];\n  }\n\n  //handles incoming data\n  handleData(){\n    //resets list of aliases names\n    this.panel.aliases = [];\n    var self = this;\n    self.series.forEach(function(data){\n      //checks if alias name has period. if it does not continue logic. if it does ignore\n      //alias must be manually set to avoid duplicate entries\n      if(data.alias.indexOf('.') < 0){\n        var lastPoint = _.last(data.datapoints);\n        var lastValue = _.isArray(lastPoint) ? parseInt(lastPoint[0]) : null;\n        self.panel.aliases.push(data.alias);\n        //check if metric exists by checking alias.\n        //if it does just update the value\n        if(self.panel.platformChildren[data.alias]){\n          self.panel.platformChildren[data.alias].value = lastValue;\n        } else {\n          //if it doesnt add a new entry\n          self.panel.platformChildren[data.alias] = {\n            name: data.alias,\n            value: lastValue,\n            warningThreshhold:100,\n            criticalThreshold:100,\n            found:true,\n            defect: {\n              name:\"OpenDefect\",\n              value:false\n            }\n          }\n        }\n      }\n    });\n  }\n  //removes entries that are not in the list of aliases.\n  //not consistent because some queries will randomly fail which\n  //will delete the entry even if not intended. REVISE\n  removeGarbage(){\n    var self = this;\n    for(var key in self.panel.platformChildren){\n      var found = false;\n      self.panel.aliases.forEach(function(alias){\n      if(alias === key){\n          found = true;\n          return;\n        }\n      })\n      if(!found){\n        delete self.panel.platformChildren[key];\n      }\n    }\n  }\n\n  //quick solution to removeGarbage. checks entries that are not\n  //part of alias list and will ignore them when computing calculations\n  checkGarbage(){\n    var self = this;\n    for(var key in self.panel.platformChildren){\n      var found = false;\n      self.panel.aliases.forEach(function(alias){\n        if(alias === key){\n          found = true;\n          return;\n        }\n      })\n      self.panel.platformChildren[key].found = found;\n    }\n  }\n\n  //if label is set to true, displays name of platform with label and ignore calculation\n  replaceNames(){\n    this.panel.labelMessage.length = 0;\n    for(var key in this.panel.platformChildren){\n      if(this.panel.platformChildren[key].defect.value){\n        this.panel.labelMessage.push(this.panel.platformChildren[key].name + \"-\" +\n        this.panel.platformChildren[key].defect.name);\n      }\n    }\n  }\n  //updates single transaction. meant to not have to run calculation on every transaction.\n  //however still need to check other transactions to update health so may not be any more efficient\n  //revise \n  updateTransaction(key){\n\n    if(!this.panel.platformChildren[key].defect.value){\n        var critical = false;\n        var warning = false;\n        var allOk = true;\n        var indexOfCritical = this.panel.labelMessage.indexOf(this.panel.platformChildren[key].name  + \" - Critical\")\n        var indexOfWarning = this.panel.labelMessage.indexOf(this.panel.platformChildren[key].name  + \" - Warning\")\n        if(this.panel.platformChildren[key].found === true){\n          if(this.panel.platformChildren[key].value >= parseInt(this.panel.platformChildren[key].criticalThreshold)){\n            this.panel.image = \"error.png\";\n            if(indexOfWarning !== -1){\n              this.panel.labelMessage.splice(indexOfWarning, 1);\n            }\n            if(indexOfCritical <= -1){\n              this.panel.labelMessage.unshift(this.panel.platformChildren[key].name + \" - Critical\");\n            }\n            critical = true;\n          } else if(this.panel.platformChildren[key].value >= parseInt(this.panel.platformChildren[key].warningThreshhold) && !critical){\n            this.panel.image = \"warning.png\";\n            if(indexOfCritical !== -1){\n              this.panel.labelMessage.splice(indexOfCritical, 1);\n            }\n            if(indexOfWarning <= -1){\n              this.panel.labelMessage.unshift(this.panel.platformChildren[key].name + \" - Warning\");\n            }\n            warning = true;\n          }\n        }\n        if(!critical && !warning){\n          if(indexOfWarning > -1){\n            this.panel.labelMessage.splice(indexOfWarning,1);\n          }\n          if(indexOfCritical > -1){\n            this.panel.labelMessage.splice(indexOfCritical,1);\n          }\n\n          this.panel.labelMessage.forEach(function(messages){\n            if(messages.indexOf(\"Warning\") > -1 || messages.indexOf(\"Critical\") > -1){\n              allOk = false;\n              return;\n            }\n          })\n          if(allOk){\n            if(this.panel.aliases.length !== 0){\n              this.panel.image = \"check.png\";\n            } else {\n              this.panel.image = \"nodata.png\";\n            }\n          }\n        }\n      }\n    this.render();\n  }\n\n  //calculates transaction based on logic given (thresholds and label values)\n  //ignores failed queries\n  calculateTransaction(){\n    var critical = false;\n    var warning = false;\n    this.panel.labelMessage.length = 0;\n    for(var key in this.panel.platformChildren){\n      if(this.panel.platformChildren[key].defect.value){\n        this.panel.labelMessage.push(this.panel.platformChildren[key].name + \"-\" +\n        this.panel.platformChildren[key].defect.name);\n      } else{\n          if(this.panel.platformChildren[key].found === true){\n            if(this.panel.platformChildren[key].value >= parseInt(this.panel.platformChildren[key].criticalThreshold)){\n              this.panel.image = \"error.png\";\n              this.panel.labelMessage.unshift(this.panel.platformChildren[key].name + \" - Critical\");\n              critical = true;\n            } else if(this.panel.platformChildren[key].value >= parseInt(this.panel.platformChildren[key].warningThreshhold) && !critical){\n              this.panel.image = \"warning.png\";\n              this.panel.labelMessage.unshift(this.panel.platformChildren[key].name + \" - Warning\");\n              warning = true;\n            }\n          }\n        }\n    }\n    if(!critical && !warning){\n      if(this.panel.aliases.length !== 0){\n        this.panel.image = \"check.png\";\n      } else {\n        this.panel.image = \"nodata.png\";\n      }\n    }\n    this.render();\n  }\n\n  link(scope, elem) {\n    this.events.on('render', () => {\n      const $panelContainer = elem.find('.panel-container');\n      if (this.panel.bgColor) {\n        $panelContainer.css('background-color', this.panel.bgColor);\n      } else {\n        $panelContainer.css('background-color', '');\n      }\n\n    });\n\n  }\n}\n\nPlatformAltCtrl.templateUrl = 'module.html';\n"]}